<html>
    <head>
        <title>HERE IS THE NEXT CLUE!</title>
        <link rel="stylesheet" type="text/css" href="./index.css">
        <script src="./index.js"></script>
        
    </head>
    <body>
        <div class="container">
            <h1 id="clue_heading">Here is your practice clue: 0</h1>
            <div class="box">
                <p id="location"> If you see too many Gatech bees, please go back and try again.</p>
            </div>
            <h4>Go back to homepage, try your answer, and save the password. If your answer is "Georgia Institute of Technology (gatech)", enter the password as "gatech". If you need help or finished at least three out of six clues, seek out a CyberQuest staff. Have fun!</h4>
            <h1>Look around</h1>
            <div class="images_list">
                <img id="1" src="./images/bee.png" alt="this is beeeee">
                <img id="2" src="./images/bee.png" alt="this is beeeee">
                <img id="3" src="./images/bee.png" alt="this is beeeee">
            </div>
            <div class="images_list">
                <img id="4" src="./images/bee.png" alt="this is beeeee">
                <img id="5" src="./images/bee.png" alt="this is beeeee">
                <img id="6" src="./images/bee.png" alt="this is beeeee">
            </div>
            <button id="homeButton" onclick="goHome()">HOME</button>
        </div>

        <script>
            function getQueryParam(param) {
                const urlParams = new URLSearchParams(window.location.search);
                const paramCount = urlParams.toString().split('&').length;
                if (paramCount > 2) {
                    alert("Nice try with length extension attack ^^");
                    goHome();
                }

                return urlParams.get(param);
            }

            const clueValue = getQueryParam('clue');
            const passValue = getQueryParam('pass');
            const clueNumber = Number(clueValue);

            
            if (!(cluePasswords[clueNumber].toLowerCase() === passValue.toLowerCase())) {
                alert("Don't crack this game, please =(( please try again.");
                goHome();
            }
          
            let nextclue = (clueNumber + 1) % cluePasswords.length;
            if (clueNumber === 0) {
                nextclue = 0;
            } else if (nextclue === 0) {
                nextclue = 1;
            }

            (nextclue == 0) ? document.getElementById("clue_heading").textContent = "This is not a clue": document.getElementById("clue_heading").textContent = "Here is your next clue: " + nextclue;

            let clueLocation;
            let imageArray = ["bee.png", "bee.png", "bee.png", "bee.png", "bee.png", "bee.png"];

            switch(nextclue) {
                case 1: 
                    clueLocation = "This clue is on the same floor as the CyberQuest room. Georgia Tech has a lot of opportunities for students. You can find multiple bulletin boards along your way. The clue is buried on one of them. Hint: it is close to rooms 1443 and 1456.";
                    break;
                case 2:
                    clueLocation = "This clue is on the second floor. It's on the side of the Exit sign. Whether you want to study alone, admire the weather, or taking a nap, this is the best place in case of emergency. Hint: near room 2456, find the pattern.";
                    break;
                case 3:
                    clueLocation = "Georgia Tech has a recycle program where students and staffs contribute by sorting trashes for recycling. If you just finished drinking a bottle of water, where would you dispose it? Hint: this is near room 2443.";
                    break;
                case 4:
                    clueLocation = "On campus, there are places where students can do group study. This place can be found on the second floor, and students would still be hydrated if they forget their water for the long study.";
                    break;
                case 5:
                    clueLocation = "In case of fire, this location is out of service. The clue is at the highest floor you could reach. You should not be here because there is no safe way to go down in a fire.";
                    break;
                case 6:
                    clueLocation = "When a student comes in from the front building, they would be impressed by glass stairs. The clue is right 'behind' something. Hint: You can see it if you stand where to take one of the pictures.";
                    break;
                default:
                    clueLocation = "CyberQuest is located at room 1440 on the first floor. The game is strictly within the classroom wing, which only includes x4xx rooms. Pick any clue with the staff and proceed your scavenger hunt on 3 different floors! You only know hints of next clue's location after enter the right password of the current one. There are 6 clues along the way.";
                    break;
            }

            document.getElementById("location").textContent = clueLocation;
            for (let i = 0; i < imageArray.length; i++) {
                document.getElementById(i + 1).src = "./images/clue" + nextclue + "/pic" + (i + 1) + ".jpg";
            }

        </script>
        
    </body>
</html>
